# 🎯 **רשימת בדיקות מקיפה ומפורטת עבור TaskFlow**

## 🔐 **קטגוריה 1: אימות ומשתמשים (Authentication & User Management)**

### **1.2 מצב המשתמש והתמדה (User State & Persistence)**

#### **📋 מבוא חשוב**
ניהול מצב המשתמש (User State) והתמדה (Persistence) ב־TaskFlow מוודא שכל משתמש נשאר מזוהה, מאובטח, ושומר על ה־Context וההרשאות שלו לאורך כל השימוש, בכל מכשיר, דפדפן, סשן או תקופת זמן. זה כולל שמירה, טעינה, רענון, חידוש, תוקף, ניתוק, ותמיכה בריבוי מכשירים.  
כל תקלה כאן עלולה להוביל ל־UX גרוע, אובדן אימות, סיכוני אבטחה, בלבול משתמשים, או Bugים עסקיים חמורים.  
הרשימה מפרטת את כל ההיבטים — UX, אבטחה, תשתית, Edge Cases, ניטור, בדיקות, ותיעוד.

---

## 🧪 **רשימת בדיקות מלאה**

### **1.2.1 שמירה וניהול Session (Session Management)**
- [ ] **Session Token מאובטח (JWT/Session Cookie):**
    - נוצר ב־Login, נשמר כ־HttpOnly, Secure, SameSite.
    - Edge: ניסיון גישה עם Token ישן/פג תוקף – החזרת 401, ניתוק.
- [ ] **Session Timeout – פקיעת סשן אחרי X דקות/שעות חוסר פעילות (Idle/Absolute Timeout).**
    - חיווי למשתמש לפני ניתוק (“הסשן שלך עומד להסתיים…”).
    - אפשרות הארכה (Refresh) אוטומטית בפעילות.
- [ ] **Renewal/Refresh Token – חידוש Session בצורה מאובטחת (Silent Refresh).**
    - שמירת Refresh Token בנפרד, לא ב־LocalStorage.
    - Edge: ניתוק אוטומטי אם Refresh נכשל (לדוג' התוקף פג).
- [ ] **ניהול Multi-Session – תמיכה בריבוי מכשירים/דפדפנים, אפשרות לראות/לנתק סשנים פעילים בפרופיל.**
    - Edge: ניתוק כפוי מכל המכשירים (בבקשה יזומה או שינוי סיסמה).

---

### **1.2.2 שימור והעמסת מצב משתמש (User Context & State Persistence)**
- [ ] **טעינת פרטי משתמש מ־Session (on refresh/app load):**
    - שם, אימייל, הרשאות, קבוצות, תפקידים, הגדרות.
    - שמירה מאובטחת – הצפנה, סינון שדות רגישים.
- [ ] **שמירה מתמשכת של מצב (Remember Me):**
    - שמירה מאובטחת של Session/Token לשימוש עתידי.
    - Edge: ביטול Remember Me – מחיקת כל Session/Token.
- [ ] **טעינת סטייט אחרון – העמוד, שיחה, משימה (Deep Linking, Last Visited).**
    - Edge: מעבר דפדפן/Device – האם ה־State נשמר/משוחזר?
- [ ] **שחזור מצב לאחר קריסת דפדפן/רענון/ניתוק רשת.**
    - Edge: קונפליקט בין סשנים – מה קורה בשינוי נתונים במקביל?

---

### **1.2.3 הרשאות, תפקידים, ומעבר ביניהם (Role & Permission State)**
- [ ] **טעינת הרשאות בזמן אמת – כל פעולה נבדקת מול ה־Session/Token/Backend.**
    - Edge: שינוי הרשאות בזמן סשן – האם המשתמש מתנתק/מתעדכן אוטומטית?
- [ ] **שמירה/טעינה של Role – Editor, Viewer, Admin וכו'.**
    - Edge: מעבר תפקיד – חיווי, עדכון UI, בדיקת הרשאות מחדש.
- [ ] **ביטול הרשאות – ניתוק/הגבלת גישה אוטומטית, חיווי ברור למשתמש.**

---

### **1.2.4 סינכרון בין מכשירים, טאבים ו־Sessions**
- [ ] **סנכרון Session בין טאבים – ניתוק/חידוש/עדכון מתבצע בכל הטאבים.**
    - Edge: שינוי סיסמה/הרשאה – כל הסשנים מתעדכנים מיד.
- [ ] **סנכרון בין מכשירים – עדכון הרשאות, ניתוק, שינוי פרופיל.**
    - Edge: סשן אחד מנוטרל – האם האחרים מגיבים?
- [ ] **הגנה על Session Fixation/Session Hijacking – בדיקת מזהה מכשיר, IP, User-Agent, OTP באירועים חריגים.**
- [ ] **שימוש ב־WebSocket/EventSource ל־Session Updates בזמן אמת (אם נדרש).**

---

### **1.2.5 Edge Cases, שגיאות, והתמודדות עם תקלות**
- [ ] **Session Expired באמצע פעולה קריטית – שמירת סטייט, חיווי, אפשרות שחזור.**
- [ ] **Token פג/נמחק – מעבר אוטומטי למסך התחברות, חיווי ברור (“המושב שלך הסתיים”).**
- [ ] **רענון/החלפת Token תוך כדי שימוש – Seamless, ללא אובדן עבודה.**
- [ ] **קריסה/כיבוי דפדפן – שחזור Session, שמירת טיוטות.**
- [ ] **Sync Conflict – שתי פעולות במקביל (טאב/Device) – מנגנון Conflict Resolution.**
- [ ] **Edge: התחברות בשני דפדפנים – ניתוק יזום/אוטומטי באירוע חריג (לדוג' חשש לפריצה).**
- [ ] **התחברות ממדינה/מכשיר לא מוכר – התראה, אימות נוסף.**

---

### **1.2.6 ניטור, לוגים, ושקיפות**
- [ ] **תיעוד כל יצירת/חידוש/סיום Session – מזהה משתמש, IP, Device, זמן, סיבה.**
- [ ] **לוג לכל שינוי הרשאות, תפקיד, Device, Token.**
- [ ] **Dashboard למנהלים – סטטיסטיקות סשנים, ניתוקים, חריגות, Abuse.**
- [ ] **התראות חריגות – ריבוי סשנים, ניסיונות גישה לא תקינים, Sync Conflicts.**
- [ ] **שימור לוגים – עמידה ב־GDPR, מחיקה יזומה, גישה רק למורשים.**

---

### **1.2.7 בדיקות אוטומטיות, QA, ואבטחת איכות**
- [ ] **בדיקות End-to-End – התחברות, ניתוק, Session Timeout, חידוש Token, Remember Me, ריבוי מכשירים.**
- [ ] **בדיקות Edge – Session Expiry, Token Revocation, שינוי הרשאות באמצע שימוש.**
- [ ] **בדיקות אבטחה – Session Fixation, Token Replay, Session Hijacking, Brute Force.**
- [ ] **בדיקות עומס – אלפי Session במקביל, חידוש Tokens המוני.**
- [ ] **בדיקות רגרסיה – שינויי קוד לא פוגעים בהתמדה/סטייט.**
- [ ] **בדיקות UX – חיווי ברור, שמירת עבודה, שחזור אוטומטי, הודעות שגיאה.**
- [ ] **בדיקות Multi-Device – מעבר בין מכשירים, ניתוק מכוון, Update Real-Time.**

---

### **1.2.8 Best Practices – מצב משתמש והתמדה**
- **Session Tokens מוצפנים, עם Expiry, Renewal, Secure/SameSite**
- **Refresh Token בנפרד, שמירת סטייט מינימלית ב־Client, לא ב־LocalStorage**
- **Session Timeout, Idle Timeout, Forced Logout**
- **סנכרון בין טאבים/מכשירים, Conflict Resolution, ניתוק יזום מכל הסשנים**
- **הגנה על Session Fixation/Hijacking, ניטור חריגות**
- **טעינת סטייט אחרון, שחזור עבודה, Remember Me מאובטח**
- **התראות ללקוח באירועים קריטיים, חיווי ברור, UX רציף**
- **בדיקות End-to-End, אבטחה, עומס, Edge, Multi-Device**
- **שקיפות – Dashboard, לוגים, סטטיסטיקות, תיעוד שינויים**
- **שיפור מתמיד – Lessons Learned, Update Cycle, הקשחה שוטפת**

---

## ✅ **סיכום**
מצב המשתמש והתמדה הם "הליבה השקטה" של TaskFlow – קריטי לאבטחה, UX, ולשמירה על אמון.  
עברו על כל סעיף, סמנו ✔️ או ❌, תעדו הערות, ותעדפו תיקונים/שיפורים לפי חומרה.

---