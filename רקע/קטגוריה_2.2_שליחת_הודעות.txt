# 🎯 **רשימת בדיקות מקיפה ומפורטת עבור TaskFlow**

## 💬 **קטגוריה 2: מערכת הצ'אט (Chat System)**

### **2.2 שליחת הודעות (Sending Messages)**

#### **📋 מבוא חשוב**
שליחת הודעות היא הליבה של מערכת TaskFlow – כל אינטראקציה, תהליך עבודה או קבלת תשובה מבוצעים סביב פעולה זו. הבדיקה חייבת להיות ברמת UI, UX, API, Edge Cases, זמינות, אבטחה, ביצועים, סנכרון, נגישות, שמירה, חוויית משתמש, וניהול תקלות – כולל כל תרחיש אפשרי, בכל מכשיר, בכל מצב.

---

## 🧪 **רשימת בדיקות מלאה**

### **2.2.1 ממשק שליחה (UI/UX of Message Input & Send Action)**
- [ ] **האם יש שדה קלט ברור לשליחת הודעה?**
    - ממוקם תמיד במקום קבוע, גודל מותאם, תומך RTL.
    - תיאור/placeholder ברור: "כתוב הודעה...", "Type a message...".
    - פוקוס אוטומטי אחרי פתיחת שיחה חדשה/מעבר בין שיחות.
    - תומך הדבקה, גרירה, בחירת כל הטקסט, בחירת שורה.

- [ ] **כפתור שליחה נגיש וגלוי:**
    - ממוקם ישירות ליד שדה הקלט, עם אייקון מתאים (שלח/Send/חץ).
    - ניתן לשלוח גם ע"י Enter (ולא רק לחיצה), תומך Shift+Enter לשורה חדשה.
    - Tooltip/אריה label נגישות.
    - פידבק חזותי במעבר עכבר, לחיצה, disable בזמן שליחה.

---

### **2.2.2 ולידציה של ההודעה (Input Validation)**
- [ ] **מניעת שליחה של הודעה ריקה:**
    - Enter על שדה ריק – לא נשלח, יש חיווי (רעד, צבע, הודעה).
    - אין אפשרות לשלוח רק רווחים/שורות ריקות.
    - Edge: הודעה הכוללת רק תווים בלתי נראים – לא נשלחת.

- [ ] **הגבלת אורך הודעה:**
    - מה האורך המקסימלי (תווים/בתים)?  
      - נסה לשלוח הודעה מעל המגבלה – מתקבלת הודעת שגיאה ברורה.
      - תומך חיתוך/גלילה של הודעות ארוכות.
    - תומך הודעות קצרצרות (Emoji, "OK", "👍").

- [ ] **בדיקת תווים מיוחדים:**
    - תומך בעברית, אנגלית, סמיילים, תווים יפניים/ערביים, סימני שאלה, HTML, Markdown.
    - אין קריסות/באגים בקלט Unicode/RTL.
    - מונע XSS/Code Injection – תווים מסוכנים נאספים/מוצגים כטקסט.

---

### **2.2.3 התנהגות שליחה**
- [ ] **מה קורה בלחיצה על שליחה?**
    - הודעה נשלחת מיידית – מופיעה מיד בחלון הצ'אט (optimistic UI).
    - מופיעה Spinner/Loader קצר (אם יש דיליי).
    - פידבק חזותי – שינוי צבע, אנימציה, מעבר שורה.
    - כפתור שליחה נכנס ל־Disable עד קבלת אישור.
    - הודעה נשלחת גם על Enter, גם על כפתור, גם על "Send" במובייל.

- [ ] **שליחה כפולה/מהירה:**
    - לחיצה כפולה על "שלח" – אין כפילות בהודעות.
    - Enter פעמיים ברצף – נשלחת רק הודעה אחת.
    - מנגנון debouncing/throttling לשליחה.

- [ ] **הודעה ארוכה – גלילה אוטומטית:**
    - שדה הקלט גודל דינמית/עם Scrollbar.
    - שדה ההודעות גולל אוטומטית להודעה החדשה.

---

### **2.2.4 טיפול בשגיאות, חיבור רשת, ודחייה**
- [ ] **מה קורה אם האינטרנט נופל/חלש?**
    - הודעה נשמרת ב־Local Storage/Queue עד חזרת החיבור.
    - אינדיקטור ברור – "ההודעה לא נשלחה, נסה שוב", Retry אוטומטי.
    - אין אובדן הודעות – הודעה נשמרת ל־Resend.

- [ ] **timeout/כשל בשרת:**
    - הודעה תקועה במצב "שולח..." – אחרי X שניות יש שגיאה ברורה.
    - אפשרות ל־Retry ידני.
    - ניהול תקלות API – קוד 429, 500, 403 וכו'.

- [ ] **כשל ב־DB/שיחה שנמחקה:**
    - ניסיון לשלוח הודעה לשיחה שכבר לא קיימת – הודעת שגיאה והסבר.
    - אין קריסה/באג – טיפול חסין.

---

### **2.2.5 תיעוד זמן, סטטוס, ואישורים**
- [ ] **האם מוצג זמן שליחה מדויק (timestamp) על כל הודעה?**
    - פורמט עקבי, עם תאריך/שעה.
    - סנכרון לפי אזור זמן המשתמש.

- [ ] **סטטוס שליחה (status):**
    - "נשלח", "בתהליך שליחה", "לא נשלח", "התקבל בשרת", "נקרא" (אם יש תמיכה).
    - חיווי גרפי (V, וי כפול, עיגול, צבע).
    - עדכון בזמן אמת (websocket/polling/long-polling).

---

### **2.2.6 סנכרון בכל הטאבים והמכשירים (Real-Time Sync)**
- [ ] **שליחה במכשיר אחד – מופיעה מיד בכל שאר המכשירים/טאבים?**
    - שימוש ב־WebSocket/Firestore Listener/Realtime DB.
    - אין Lag/דיליי מורגש; Refresh בטאב אחר – רואה הודעה.
    - ניסיון לשלוח אותה הודעה פעמיים – אין כפילות.

- [ ] **שליחה בזמן Offline – סנכרון אחרי התחברות:**
    - הודעה שנשלחה Offline מסתנכרנת מיד עם החיבור.
    - אינדיקטור ברור – ממתין לשליחה, ואז "נשלח".

---

### **2.2.7 נגישות וחוויית משתמש**
- [ ] **שדה קלט תומך מקלדת בלבד, tab-index, aria-labels.**
- [ ] **אפשרות הגדלת פונט, מצב כהה/בהיר, קונטרסט מספק.**
- [ ] **תמיכה ב־Screen Reader – קריאת הודעות, סטטוס, שגיאות.**
- [ ] **RTL מלא – הודעות בעברית מיושרות לימין, אנגלית לשמאל.**
- [ ] **חיווי ברור כאשר משתמש אינו מורשה לשלוח הודעות (Guest/הרשאות).**
- [ ] **נגישות ב־Mobile: תמיכה במקלדת מסך, תפריטי נגישות.**

---

### **2.2.8 Edge Cases & תרחישים מיוחדים**
- [ ] **שליחת 1000 הודעות ברצף – Rate Limiting? הודעת שגיאה כשנחסם.**
- [ ] **הודעות עם סמיילים, קישורים, קוד, HTML – תצוגה תקינה, אין XSS.**
- [ ] **Copy-Paste של טקסט גדול – תומך, לא קורס.**
- [ ] **שליחת הודעות עם תווים שאינם תקניים – תומך/error.**
- [ ] **שליחת הודעה בדיוק בזמן מעבר בין שיחות – מה קורה?**
- [ ] **הודעה שמתבצעת בזמן Logout/Session Timeout – נשלחת? נשמרת? נעלמת?**
- [ ] **הודעה שנשלחת לשיחה שנמחקה – חיווי/שגיאה.**
- [ ] **בדיקת שליחת הודעה עם קובץ מצורף – האם אפשר? האם יש גבול גודל?**

---

### **2.2.9 אבטחת מידע**
- [ ] **כל שליחת הודעה מאובטחת ב־Token/JWT, אין אפשרות spoofing.**
- [ ] **אין אפשרות לשלוח הודעה בשם משתמש אחר.**
- [ ] **הודעות מוצפנות בתעבורת רשת (HTTPS בלבד).**
- [ ] **ניסיון לשלוח הודעה עם session ישן/לא תקף – נדרשת התחברות מחדש.**
- [ ] **מניעת שליחת הודעות ב־API ללא הרשאות.**
- [ ] **בדיקת XSS (סקריפט בהודעה), SQL/NoSQL Injection.**
- [ ] **בדיקת CSRF – רק משתמש מחובר יכול לשלוח.**

---

### **2.2.10 תיעוד, לוגים, אנליטיקס**
- [ ] **כל שליחת הודעה מתועדת ב־log עם מזהה משתמש, זמן, מזהה שיחה.**
- [ ] **אין שמירת תוכן רגיש בלוגים.**
- [ ] **אפשרות לראות סטטיסטיקות – ממוצע זמן שליחה, כמות הודעות שנשלחו, שגיאות שליחה.**
- [ ] **מערכת התרעות – התראה אוטומטית למפתחים על תקלה גורפת בשליחת הודעות.**

---

### **2.2.11 בדיקות אוטומטיות/ידניות**
- [ ] **בדיקות Cypress/Playwright/Selenium – כל התרחישים הנ"ל.**
- [ ] **בדיקות יחידה (unit) לאובייקט הודעה.**
- [ ] **בדיקות אינטגרציה – API, DB, סנכרון.**
- [ ] **בדיקות עומס (Load Test) על שליחה רציפה.**
- [ ] **בדיקת התאוששות מ־Crash באמצע שליחה.**

---

## 🏅 **Best Practices ל־TaskFlow**
- **שליחה מיידית, חיווי ברור, הודעות אינטואיטיביות.**
- **מניעת כפילות, בדיקת תקינות, הצפנה וזיהוי.**
- **סנכרון בזמן אמת, חוויית משתמש אחידה בכל מכשיר.**
- **בדיקות אוטומטיות לכל Edge Case.**
- **פידבק לכל כשל/הצלחה.**
- **נגישות מושלמת לכל מצב.**
- **הגדרת מגבלות תווים/הודעות, עם הודעה מתאימה.**
- **ניהול תורים לשליחה במצב offline.**

---

## ✅ **סיכום**
שליחת הודעות היא אבן היסוד של TaskFlow – כל סעיף כאן קריטי לאמינות, נוחות ושביעות רצון המשתמש.  
סמנו ✔️ או ❌ לכל סעיף – ותעדפו תיקונים/אופטימיזציות בהתאם.

---