# 🎯 **רשימת בדיקות מקיפה ומפורטת עבור TaskFlow**

## 💾 **קטגוריה 4: שמירה וסנכרון נתונים (Data Persistence & Sync)**

### **4.1 שמירה אוטומטית (Autosave)**

#### **📋 מבוא חשוב**
שמירה אוטומטית (Autosave) היא אחת מאבני היסוד של TaskFlow – שמירה בזמן אמת של שיחות, הודעות, הגדרות, טיוטות ונתוני משתמש.  
היא נועדה למנוע אובדן מידע, לתמוך בעבודה רב־מכשירית, לאפשר התאוששות מתקלות ולספק חוויית משתמש רגועה ("לא צריך לחשוש").  
רשימה זו מתעמקת בכל תרחיש – UX, Edge Cases, ביצועים, אבטחה, זמני תגובה, עבודה Offline, תיעוד, לוגיקה עסקית, בדיקות ושיפור.

---

## 🧪 **רשימת בדיקות מלאה**

### **4.1.1 טריגרים לשמירה (When & What to Save)**
- [ ] **מה נשמר אוטומטית?**
    - הודעות שנכתבו אך לא נשלחו (טיוטה).
    - הודעות שנשלחו (Sent).
    - פתיחת שיחה חדשה – נשמרת מייד או רק אחרי שליחת הודעה?
    - שינוי שם שיחה, מחיקה, שיתוף, תיוג, העברת שיחה.
    - העדפות משתמש (Theme, שפה, קיצורי דרך), סטטוס.
    - קבצים מצורפים (Uploaded Files).

- [ ] **מתי נשמר אוטומטית?**
    - OnBlur (יציאה משדה קלט).
    - OnChange (כל הקלדה/שינוי).
    - Periodic Autosave (כל X שניות/דקות).
    - OnSend (בלחיצה על "שלח" או Enter).
    - לפני רענון/סגירת טאב (beforeunload).
    - בעת מעבר בין שיחות/קטגוריות.

- [ ] **Edge: עבודה בטאב נוסף/Sync – האם שמירה מתבצעת בכל טאבים?**

---

### **4.1.2 UX של שמירה אוטומטית**
- [ ] **אינדיקציה למשתמש על שמירה:**
    - אייקון/טקסט קטן "נשמר אוטומטית", "Saved", "טיוטה נשמרה".
    - תאריך/שעה אחרונה של שמירה אוטומטית.
    - חיווי ויזואלי ברור בעת שמירה (אנימציה, spinner, שינוי צבע זמני).

- [ ] **האם המשתמש יודע מתי שמרה?**
    - הודעת שגיאה ברורה במקרה של כשל בשמירה ("לא נשמר, נסה שוב").
    - Edge: שמירה שמתבצעת ברקע – אין קפיצות/הפרעות בשימוש.

- [ ] **אפשרות לשחזר טיוטה/מידע לא שמור:**
    - פופ־אפ עם אפשרות "שחזר טיוטה".
    - הצגת ההבדלים בין טיוטה ישנה לחדשה (Diff).

- [ ] **האם יש Undo/Redo לפעולות שמירה אוטומטית?**

---

### **4.1.3 מניעת אובדן מידע**
- [ ] **מה קורה ברענון/סגירה?**
    - לפני close/refresh – האם נשמר אוטומטית?
    - Edge: ניתוק רשת/קריסת דפדפן – האם המידע נשמר ב־Local Storage/IndexedDB עד חזרה לאינטרנט?
    - בדיקת Recovery – הפעלה מחדש/Log Back In – האם כל המידע נשמר?

- [ ] **שמירה גם ב־Offline:**
    - עבודה בלי אינטרנט – האם מידע נשמר מקומית?
    - סנכרון אוטומטי עם התחברות מחדש (Conflict Resolution).
    - Edge: עבודה ממושכת ב־Offline ואז חיבור – מה קורה בשני טאבים/מכשירים?

- [ ] **האם יש Auto-Recover במקרה של כשל שמירה/התנגשות?**

---

### **4.1.4 ביצועים ותזמון**
- [ ] **מהירות שמירה:**
    - שמירה תוך פחות מ־500ms בממוצע (לא מורגשת עיכוב).
    - אין "הקפאת" UI בזמן שמירה.
    - Edge: שמירה של קבצים גדולים/שיחות ענקיות – אין השהיית UI.

- [ ] **Rate Limiting:**
    - אין שמירות מיותרות (Debounce/Throttle – שמירה אחת כל X שניות/פעולות).
    - אין "הצפה" של ה־DB בקריאות שמירה מיותרות.
    - Edge: הקלדה מהירה/הדבקת טקסט ארוך – נשמר בתדירות נכונה.

- [ ] **שחזור אוטומטי מה־Cache במקרה של Timeout/כשל שרת.**

---

### **4.1.5 תאימות וסנכרון בין מכשירים/טאבים**
- [ ] **סנכרון מיידי לכל המכשירים:**
    - שמירה בטלפון – מופיעה מיד במחשב (Realtime Sync, Firestore, WebSocket).
    - עבודה ממושכת ב־Desktop – מעבר למובייל – כל הטיוטות/הודעות/שיחות עוברות במיידי.

- [ ] **קונפליקטים בין מכשירים:**
    - עריכה בו־זמנית – מנגנון Conflict Resolution (Winner, Merge, הודעה למשתמש).
    - Edge: שמירה אוטומטית במכשיר א' ומחיקה במכשיר ב' בו־זמנית.

- [ ] **שמירה בטאב פתוח – האם משנה מצב בטאבים אחרים? האם יש BroadcastChannel/StorageEvent?**
    - Edge: שמירה בטאב סגור – האם מסתנכרן בפתיחה מחדש?

---

### **4.1.6 מה נשמר – ומה לא?**
- [ ] **שדות שלא נשמרים אוטומטית (למשל, סיסמאות, נתונים רגישים) – האם מסומנים ככאלה?**
    - Edge: ניסיון לשמור מידע אסור – האם נזרק/מוצפן?

- [ ] **בדיקת קבצים מצורפים – האם שמירה אוטומטית שומרת גם אותם?**
    - מה קורה עם קובץ ב־Upload שלא הושלם?

- [ ] **בדיקת רגרסיה – שמירה של שדות חדשים/ישנים – אין אובדן נתונים בשל עדכון גרסה.**

---

### **4.1.7 הרשאות, אבטחה ופרטיות**
- [ ] **שמירה מאובטחת – כל קריאה/עדכון עוברת דרך API עם Token/JWT.**
    - אין אפשרות למשתמש זר לצפות/לשנות נתונים.
    - אין שמירה של מידע רגיש ב־Local Storage ללא הצפנה.

- [ ] **בדיקת הרשאות – האם כל משתמש שומר רק את המידע שלו?**
    - Edge: מעבר בין חשבונות – אין שיתוף/זליגה של טיוטות/שיחות.

- [ ] **שמירה מוצפנת של נתונים רגישים (Client-Side Encryption במידע שמור מקומית).**
    - Edge: עבודה במחשב ציבורי – אין זליגה למשתמש הבא.

- [ ] **שמירה אוטומטית לא יוצרת "גרסאות רפאים" (Zombie Drafts) – ניקוי אוטומטי של טיוטות שלא בשימוש.**

---

### **4.1.8 לוגים, ניטור, תיעוד (Logging & Monitoring)**
- [ ] **כל שמירה נרשמת בלוג – זמן, משתמש, סוג פעולה, מצב (הצלחה/כשלון).**
    - אפשרות להוציא דוח שמירות אוטומטיות.
    - Edge: ניטור שמירות כושלות – התראה למפתחים.

- [ ] **בדיקות עומס – האם שמירה אוטומטית שורדת 1000 משתמשים במקביל?**
    - ניטור DB – עומס, תקלות, זמני תגובה.

- [ ] **בדיקת זליגות – אין שמירות כפולות/יתרות/נתוני Test Production.**

---

### **4.1.9 בדיקות אוטומטיות/ידניות**
- [ ] **בדיקות Cypress/Playwright – הקלדה, שמירה, רענון, Offline, שחזור טיוטה.**
- [ ] **בדיקות Edge – עבודה במספר טאבים, רשת נופלת, סגירת טאב פתאומית, מעבר בין משתמשים.**
- [ ] **בדיקת Restore – שחזור נתונים אחרי Logout/Login, קריסת דפדפן, מעבר בין מכשירים.**
- [ ] **בדיקות עומס – הרבה שמירות במקביל, הקלדה במספר שדות, שמירת קבצים גדולים.**

---

## 🏅 **Best Practices ל־TaskFlow – שמירה אוטומטית**
- **שמירה OnChange/OnInterval חכם (לא "הצפה").**
- **חיווי ברור למשתמש ("נשמר אוטומטית", "שגיאה בשמירה").**
- **שמירה אוטומטית מכל מכשיר וטאב, כולל Recovery Offline.**
- **הצפנה/אבטחה – אין שמירת מידע רגיש ב־Local Storage פתוח.**
- **מנגנון Conflict Resolution לכל סנכרון.**
- **בדיקות אוטומטיות לכל תרחיש Edge.**
- **תיעוד לוגים – כל שמירה, כשל, שיחזור, שחזור.**
- **ניהול Zombie Drafts – טיוטות ישנות נמחקות אוטומטית.**
- **הגדרות גמישות – זמן/תדירות שמירה, אופציית ביטול/שחזור.**
- **התראות למפתחים – שמירות כושלות, תקלות Sync.**

---

## ✅ **סיכום**
שמירה אוטומטית היא מנגנון קריטי לחוויית משתמש, אבטחת מידע, והתמודדות עם תקלות.  
עברו על כל סעיף, סמנו ✔️ או ❌, תעדו הערות, ותעדפו תיקונים/שיפורים לפי חומרה.

---