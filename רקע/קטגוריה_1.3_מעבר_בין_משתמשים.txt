# 🎯 **רשימת בדיקות מקיפה ומפורטת עבור TaskFlow**

## 📋 **קטגוריה 1.3: מעבר בין משתמשים (User Switching)**

### **מבוא**
מעבר בין משתמשים הוא תרחיש קריטי באפליקציה כמו TaskFlow: במחשבים משותפים, במעברים בין חשבונות ובשימושים רציפים. חובה להבטיח בידוד, אבטחה, נוחות ו־UX מושלם.  
ברשימה זו תמצא את כל תרחישי הבדיקה, השאלות, והסימנים המעשיים להצלחה – ברמה הגבוהה ביותר.

---

### **1.3 מעבר בין משתמשים – מטרות**
- למנוע כל ערבוב נתונים בין משתמשים.
- לאפשר מעבר חלק בין חשבונות.
- להציג חיווי משתמש פעיל ברור.
- לשמור על אבטחה, פרטיות ו־UX מיטבי.

---

## 🧪 **רשימת בדיקות מלאה**

### **1.3.1 איך מתחבר כמשתמש אחר? (User Switching Flow)**
- [ ] **כפתור יציאה (Logout) נגיש וברור:**  
      - ממוקם תמיד באותו מקום, עם אייקון וטקסט.
      - נגיש מכל מסך (גם בצ'אט, גם בלוח ההגדרות וכו').
      - לא מוסתר בתפריטים עמוקים.

- [ ] **בלחיצה על Logout – מה קורה?**  
      - הסשן נמחק מיד (Session, Tokens, Local Storage, Cookies).
      - מעבר אוטומטי למסך התחברות ללא השהיה.
      - כל ניסיון לעקוף (Back בדפדפן) – חוזר להתחברות.

- [ ] **התחברות כמשתמש חדש:**  
      - אחרי Logout, אפשר להתחבר עם משתמש/אימייל אחר.
      - אין אפשרות להתחבר פעמיים ללא התנתקות.
      - ניסיון להתחבר כמשתמש אחר בלי Logout – האם מותר? האם מופיעה אזהרה?

- [ ] **קלות מעבר – כמה קל להחליף חשבון?**  
      - האם צריך למלא תמיד מחדש את כל הפרטים?
      - האם יש "Remember X"/"Switch Account" כמקובל באפליקציות מודרניות?

---

### **1.3.2 מה קורה אם 2 אנשים מחוברים באותו מחשב?**
- [ ] **בידוד מוחלט:**  
      - כל משתמש רואה רק את הנתונים שלו – שיחות, הגדרות, פרופיל, שמות, הרשאות.
      - אין ערבוב במידע – גם לא אחרי רענון, סגירה ופתיחה מחדש.

- [ ] **טאבים מרובים באותו דפדפן:**  
      - פתח טאב A, התחבר כ-UserA. פתח טאב B, בצע Logout והתחבר כ-UserB.
      - האם הטאב השני מתעדכן אוטומטית (Logout אוטומטי / מעבר לחשבון החדש)?
      - האם אפשר להפעיל שני חשבונות במקביל? אם כן – מה קורה בשמירת נתונים/שליחת הודעה?

- [ ] **שימוש בפרופילים שונים בדפדפן:**  
      - בדוק עם Chrome Profiles – הפרדה מלאה בין החשבונות.

- [ ] **מה קורה בשימוש "Incognito"/"Private"?**  
      - האם ניתן לפתוח חשבון נוסף במקביל? האם יש בידוד מושלם?

---

### **1.3.3 איך יודעים איזה משתמש פעיל?**
- [ ] **חיווי ברור למשתמש מחובר:**  
      - שם מלא, אימייל, תמונת פרופיל, אייקון, greeting ("שלום, atiaron").
      - מוצג באופן עקבי, ב־Header/Sidebar/Dropdown.
      - לא מוסתר/מקוצר/בלתי קריא.
      - משתנה מיידית לאחר החלפת משתמש.

- [ ] **פעולה בשם המשתמש הנכון:**  
      - כל שליחת הודעה, יצירה, שינוי – מבוצעת תחת המשתמש הנכון, גם אחרי מעבר.
      - אין מצב שבו פעולה נרשמת בשם משתמש קודם (למשל – שליחת הודעה אחרי התנתקות/מעבר).
      - בעת לחיצה על פרטי המשתמש – קישור לעמוד פרופיל/הגדרות רלוונטי.

---

### **1.3.4 המתנתק ונכנס מישהו אחר – אין ערבוב נתונים?**
- [ ] **ניקוי מוחלט של State:**  
      - לאחר Logout – כל Cache/Draft/LocalStorage של נתונים רגישים נמחק.
      - אין בשום מקום (DevTools, סטוראז', זיכרון) מידע של המשתמש הקודם.
      - אחרי כניסה של משתמש חדש, כל המסכים/רשימות/צ'אטים שייכים רק לו.

- [ ] **בדיקת Back/Forward בדפדפן:**  
      - האם אפשר לראות מידע של המשתמש הקודם ע"י חזרה אחורה? חובה שלא!
      - שימוש ב־Cache-Control/No-Store + ניקוי State ב־mount של כל קומפוננטה.

- [ ] **בדיקת API Tokens:**  
      - אחרי Logout: כל Token/Session/Refresh Token בטלים.
      - ניסיון לשלוח בקשות לשרת עם Token ישן – מחזיר 401/403 ולא מידע של משתמש קודם.

- [ ] **האם יש "Session Fixation"?**  
      - התחברות כמשתמש חדש = יצירת Session חדש לגמרי.

- [ ] **בדיקת Local Notifications, Push, Web Workers ו־Service Workers:**  
      - אין קבלת התראות של משתמש ישן, או קבלת מידע push לא נכון.

---

### **1.3.5 טאבים מרובים (Tab Sync)**
- [ ] **Logout בטאב אחד – Logout בכולם:**  
      - מנגנון BroadcastChannel/Storage Event שמסנכרן Logout/Account Change לכל הטאבים.
      - ניסיון לבצע פעולה בטאב ישן – אמור להחזיר לדף התחברות.
      - חיווי ברור ("נותקת במכשיר אחר, נא להתחבר שוב").

- [ ] **התחברות כמשתמש אחר בטאב אחד – סנכרון:**  
      - כל הטאבים עוברים לחשבון החדש, או מתנתקים אוטומטית.

- [ ] **טאבים פתוחים במקביל – אין ערבוב נתונים:**  
      - שינוי ב־Tab אחד (מחיקת שיחה, שינוי שם) – משפיע רק על המשתמש המחובר.

---

### **1.3.6 מכשירים מרובים**
- [ ] **התחברות במקביל במחשב, מובייל, טאבלט:**  
      - כל שינוי (שיחה, הודעה, מחיקה) מסונכרן מיידית.
      - Logout במכשיר אחד – האם מתנתק גם בשאר? (בהגדרות אבטחה מוקשחות)
      - אין מצב שבו יופיעו שיחות/נתונים של משתמש אחר.

- [ ] **בדיקת Edge Cases:**  
      - כניסה כ־UserA במחשב, כ־UserB בטלפון – אין ערבוב בשום תרחיש.
      - מחיקת שיחה במכשיר אחד – נמחקת רק אצל המשתמש הרלוונטי.

---

### **1.3.7 תרחישי קצה (Edge Cases)**
- [ ] **האם ניתן להיכנס כמשתמש אחר מבלי Logout?**  
      - בדוק התנהגות – האם מתריע? האם מתאפשר?  
      - מה קורה לטאבים פתוחים? מה קורה לנתונים שלא נשמרו?

- [ ] **Crash/Reboot באמצע מעבר משתמשים:**  
      - באג "נתקעתי בין חשבונות" – האם אפשר להיתקע ללא User/State?
      - האם יש fallback אוטומטי – מעבר למסך התחברות?

- [ ] **שימוש במכשיר ציבורי/ספריה:**  
      - Logout מוחלט, ניקוי נתונים, אין שום זיכרון למשתמש הקודם.

---

## 🚨 **בדיקות אבטחה קריטיות**
- [ ] **ניקוי Local Storage/IndexedDB/Session Storage לאחר Logout.**
- [ ] **הגדרת SameSite=Strict לכל Cookie.**
- [ ] **תגובה ל־Session Hijack/Token Theft – האם אפשר לראות נתונים של משתמש קודם?**
- [ ] **ניסיון להריץ API עם Token ישן/נמחק – קבלת 401 בלבד.**
- [ ] **ב־DevTools – אין אפשרות לשלוף נתונים רגישים של משתמש קודם.**
- [ ] **הודעות שגיאה/הצלחה ברורות: "נותקת", "התחברת", "גישה נדחתה".**

---

## 🏅 **Best Practices ל־TaskFlow**
- **השתמש ב־BroadcastChannel/StorageEvent לסנכרון טאבים.**
- **בדוק תרחישי "Tab Mix" – טאבים פתוחים, סגירה, רענון, מעבר חשבון.**
- **בדוק Multi-Device – האם יש Sync מלא לכל שינוי, Logout וכו'.**
- **הגדר Session Expiry קפדני (Timeout).**
- **הצפן Tokens ונתונים רגישים ב־storage.**
- **הוסף בדיקות Cypress/Playwright לכל התרחישים.**
- **הצג למשתמש תמיד – מי מחובר, וודא "שלום X" רלוונטי.**
- **אפשר אופציה "שכח אותי" / "התנתק מכל המכשירים" (אם רלוונטי).**

---

## ✅ **סיכום**
מעבר בין משתמשים הוא אחד ה־pain points הכי חשובים לאבטחת מידע, פרטיות ו־UX.  
לכן חובה לעבור על כל נקודה כאן, לסמן ✔️ מה שעובד, ולתעדף שיפורים מידיים על כל חריגה.  
**כל תרחיש ערבוב או דליפת מידע – בגדר Critical!**

---

**בהצלחה! רוצה שאעבור לקטגוריה 2?**  